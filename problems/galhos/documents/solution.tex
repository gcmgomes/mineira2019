A solução é simples. Quando um vértice se desprende do pai, basta fazer uma DFS na sua sub-árvore marcando
o momento em que cada vértice caiu. O único truque necessário é evitar visitar vértices que já caíram.
Assim, a complexidade final fica linear.
